function extract
clc;clear all;close all

PCdata=[ ...
0., 0.0436
6.6832, 0.0499
10.6931, 0.0548
12.4752, 0.0562
19.604, 0.0646
28.5149, 0.0673
37.4257, 0.0729
43.6634, 0.0771
51.6832, 0.0799
58.8119, 0.0799
64.1584, 0.0714
71.2871, 0.063
76.6337, 0.0545
82.8713, 0.046
90.8911, 0.039
99.802, 0.0291
109.604, 0.0249
117.6238, 0.0192
126.5347, 0.0192
134.5545, 0.0121
142.5743, 7.8744e-3
149.7029, 9.2517e-3
161.2871, 6.3962e-3
171.0891, 7.7631e-3
179.1089, 4.9215e-3
187.1287, 6.9979e-3
192.9207, 6.9753e-3
198.2673, 6.9545e-3
202.7227, 8.3422e-3
208.5149, 8.3196e-3
213.4158, 6.1928e-3
218.3168, 6.8762e-3
224.1089, 7.5562e-3
228.1188, 8.2431e-3
232.5743, 8.2257e-3
237.0297, 7.5057e-3
241.9306, 8.8918e-3
248.1683, 8.1648e-3
253.0693, 8.8483e-3
257.9703, 8.1266e-3
261.5347, 9.5178e-3
266.4356, 9.4987e-3
272.2277, 0.013
275.7921, 0.0137
281.1386, 0.0144
285.5941, 0.0129
290.0495, 0.0143
294.9505, 0.015
299.4059, 0.0143
303.4158, 0.0143
307.8713, 0.0178
313.6634, 0.0184
319.4554, 0.0198
323.4653, 0.0191
327.0297, 0.0191
329.7029, 0.0198
334.1584, 0.0191
340.8416, 0.019
344.4059, 0.0204
346.1881, 0.0246
349.7525, 0.0281
352.4257, 0.0316
355.099, 0.0351
358.6634, 0.0372
];
% mu=56.965629823857817
% sigma=8.812368160574666

BCdata=[ ...
-1.7822, 0.0569
1.7822, 0.0632
5.7921, 0.0688
8.4653, 0.0758
10.6931, 0.0836
12.9207, 0.0885
15.5941, 0.0962
18.7128, 0.1032
20.9405, 0.1095
24.0594, 0.1151
24.9505, 0.125
28.0693, 0.1327
28.0693, 0.1411
31.1881, 0.1467
30.7426, 0.1566
32.5248, 0.1629
34.7525, 0.1692
36.5347, 0.179
38.7624, 0.1867
36.9802, 0.191
39.6535, 0.1987
41.4356, 0.2078
43.6634, 0.2155
45.4455, 0.2239
45.0, 0.2331
46.7822, 0.2422
47.6733, 0.2513
48.1188, 0.2591
48.5644, 0.2668
49.0099, 0.2724
49.901, 0.2793
50.3465, 0.2865
51.6832, 0.2934
52.5743, 0.3005
53.9109, 0.3089
53.9109, 0.3174
55.2475, 0.3244
56.1386, 0.3307
57.0297, 0.3384
57.9207, 0.3447
58.3663, 0.3511
58.3663, 0.358
60.1485, 0.3644
60.5941, 0.3721
60.5941, 0.3785
61.9306, 0.3848
61.4851, 0.3911
62.8218, 0.3946
64.1584, 0.4058
65.495, 0.4143
64.1584, 0.422
65.495, 0.4311
66.8317, 0.4367
68.1683, 0.4452
71.2871, 0.4536
72.1782, 0.4655
73.0693, 0.4747
74.8515, 0.483
74.4059, 0.4929
75.297, 0.4999
77.0792, 0.507
77.5248, 0.5168
78.4158, 0.5259
79.7525, 0.5343
81.9802, 0.5442
82.4257, 0.5547
86.4356, 0.561
90.8911, 0.5526
94.4554, 0.5462
99.3564, 0.5392
100.2475, 0.5308
103.8119, 0.5251
105.5941, 0.5188
106.0396, 0.5104
106.9306, 0.5047
107.8218, 0.4969
108.2673, 0.49
109.604, 0.4836
110.495, 0.4738
111.386, 0.4675
111.8317, 0.4605
113.6139, 0.4534
114.505, 0.445
114.0594, 0.438
115.8416, 0.4288
117.1782, 0.4203
118.0693, 0.4141
119.4059, 0.407
121.6337, 0.3993
121.6337, 0.388
122.5248, 0.3796
123.8614, 0.3698
123.8614, 0.3627
126.0891, 0.355
126.9802, 0.3466
127.4257, 0.3381
127.8713, 0.329
129.6535, 0.3206
131.4356, 0.3121
131.8812, 0.3016
132.3267, 0.2932
133.6634, 0.2875
135.0, 0.2798
135.4455, 0.2735
137.6733, 0.2643
137.2277, 0.2545
138.5644, 0.244
139.4554, 0.2341
140.7921, 0.2257
142.1287, 0.2179
143.9109, 0.2102
143.4653, 0.1997
143.9109, 0.1941
145.2475, 0.1863
145.6931, 0.1786
148.8119, 0.1708
149.7029, 0.1645
151.4851, 0.1568
150.5941, 0.1505
154.604, 0.1434
155.495, 0.1343
157.2772, 0.1258
158.6139, 0.1195
160.396, 0.1118
161.7327, 0.1026
165.297, 0.0949
164.8515, 0.0879
167.0792, 0.0801
170.6436, 0.0738
175.099, 0.0689
179.1089, 0.0646
182.2277, 0.059
186.2376, 0.0548
189.3564, 0.0498
192.9207, 0.0428
197.3761, 0.0393
199.1584, 0.0358
206.7327, 0.0301
212.5248, 0.028
218.3168, 0.0273
222.7723, 0.0272
226.3366, 0.0265
231.2376, 0.0265
236.1386, 0.0272
240.5941, 0.0244
243.2673, 0.0236
247.7227, 0.0243
251.7327, 0.0215
256.6337, 0.0222
259.7525, 0.0201
263.7624, 0.0172
268.6634, 0.0158
267.3267, 0.0165
274.0099, 0.0172
279.3564, 0.0228
285.5941, 0.0242
288.2673, 0.0228
292.2772, 0.0213
295.8416, 0.0206
299.8515, 0.0213
303.4158, 0.022
307.8713, 0.0241
311.4356, 0.0241
315.0, 0.0262
319.901, 0.0269
323.0198, 0.0304
325.6931, 0.0317
329.2574, 0.0303
334.604, 0.0317
338.6139, 0.0331
342.6238, 0.0352
346.1881, 0.0394
350.6436, 0.0422
353.7624, 0.0478
355.9901, 0.052
360.0, 0.0569
];
% mu=88.405175905003787
% sigma=0.727776975869855

xdata = BCdata(:,1);
ydata = BCdata(:,2);


% x0 = [88.405175905003787; 0.727776975869855; 88.405175905003787; 0.727776975869855] % Starting guess, x0(1)=mu, x0(2)=sigma;
x0 = [88.405175905003787; 0.727776975869855; 1.0] % Starting guess, x0(1)=mu, x0(2)=sigma;
[x,resnorm] = lsqcurvefit(@myfun,x0,xdata,ydata)

xdata=0:0.01:360;

% Plot approximation
F_PC = myfun(x,xdata);

% % Plot PC data
% mu=88.405175905003787;
% sigma=0.727776975869855;
% F_BC = 1./(sigma*sqrt(2*pi)).*exp(-((x-mu).^2)./(2*sigma^2));
% P_BC = normcdf(x,mu,sigma);


% % Plot PC data
% mu=56.965629823857817;
% sigma=8.812368160574666;
% F_PC = 1./(sigma*sqrt(2*pi)).*exp(-((x-mu).^2)./(2*sigma^2));
% P_PC = normcdf(x,mu,sigma);
% 
% % Plot PC data
% mu=88.405175905003787;
% sigma=0.727776975869855;
% F_BC = 1./(sigma*sqrt(2*pi)).*exp(-((x-mu).^2)./(2*sigma^2));
% P_BC = normcdf(x,mu,sigma);


figure(1);hold on
% plot(PCdata(:,1), PCdata(:,2),'*r');
plot(BCdata(:,1), BCdata(:,2),'*b');
plot(xdata,F_PC,'-');
% plot(x,P_PC,'-');
% plot(x,F_BC,'-r');    
% plot(x,P_BC,'-r');
end

function F = myfun(x,xdata)
mu=x(1);
sigma=x(2);
A=x(3);
% mu2=x(3);
% sigma2=x(4);

rad_data=xdata.*(2.*pi)./360;
% F = 1./(sigma*sqrt(2*pi)).*exp(-((xdata-mu).^2)./(2*sigma^2));
% F = A.*exp(-((xdata-mu).^2)./(2*sigma^2));
F = A1.*cos(rad_data)+A2.*sin(rad_data);
end